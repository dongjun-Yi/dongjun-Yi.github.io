---
title: "[Spring] ì´í•´ë¥¼ ìœ„í•œ ì˜ˆì œ"
author:
  name: dongjun-Yi
categories: [Spring]
tags: [java, Spring]
render_with_liquid: false
---
## ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­

---

- íšŒì›
    - íšŒì›ì„ ê°€ì…í•˜ê³  ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.
    - íšŒì›ì€ ì¼ë°˜ê³¼ VIP ë“±ê¸‰ì´ ìˆë‹¤.
    - íšŒì› ë°ì´í„°ëŠ” ìì²´ DBë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆê³ , ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ì—°ë™í•  ìˆ˜ ìˆë‹¤.

**íšŒì› í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨**

![Untitled.png](/assets/images/Spring_EX/Untitled.png)

**íšŒì› ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨**

![Untitled1.png](/assets/images/Spring_EX/Untitled 1.png)

- ì£¼ë¬¸
    - íšŒì›ì€ ìƒí’ˆì„ ì£¼ë¬¸í•  ìˆ˜ ìˆë‹¤.
    - íšŒì› ë“±ê¸‰ì— ë”°ë¼ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
    - í• ì¸ ì •ì±…ì€ ëª¨ë“  VIPëŠ” 1000ì›ì„ í• ì¸í•´ì£¼ëŠ” **ê³ ì • ê¸ˆì•¡ í• ì¸**ì„ ì ìš©í•œë‹¤.**(ë‚˜ì¤‘ì— ë³€ê²½ ê°€ëŠ¥)**

**ì£¼ë¬¸ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨**

![Untitled2.png](/assets/images/Spring_EX/Untitled 2.png)
**ì£¼ë¬¸**

```java
public class OrderServcieImpl implements OrderService {

	  private final MemberRepository memberRepository = new MemoryMemberRepository();
	  private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    public OrderServcieImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discount = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discount);
    }
}
```

**ì£¼ë¬¸ ê°ì²´ ë‹¤ì´ì–´ê·¸ë¨**

![Untitled3.png](/assets/images/Spring_EX/Untitled 3.png)

ë§Œì•½, ì—¬ê¸°ì„œ í• ì¸ ì •ì±…ì´ ê³ ì • ì •ì±… í• ì¸ì´ ì•„ë‹ˆë¼ ë¹„ìœ¨ì— ë”°ë¥¸ ì •ì±…ìœ¼ë¡œ ë°”ê¾¸ê²Œ ëœë‹¤ë©´ OrderServiceImplì˜ ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •ëœë‹¤.

OrderServiceImpl

```java
public class OrderServiceImpl implements OrderService {
    //private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
		private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
```

<aside>
ğŸ‘‰ ì´ì™€ ê°™ì´ í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImplì„ ìˆ˜ì •í•´ì•¼ ë˜ëŠ”ë°, ì´ëŠ” OCPì™€ DIPë¥¼ ìœ„ë°˜í•˜ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

</aside>

OrderServiceImplì€ ì§€ê¸ˆ ì¸í„°í˜ì´ìŠ¤(DiscountPolicy)ë¥¼ ì˜ì¡´í•˜ë©´ì„œ ë™ì‹œì— êµ¬í˜„ í´ë˜ìŠ¤(RateDiscountPolicy)ë„ ì˜ì¡´í•˜ê³  ìˆê¸° ë•Œë¬¸ì— DIP(Dependency Inersion Principle)ë¥¼ ì§€í‚¤ì§€ ëª»í–ˆê³ , RateDiscountDisplayì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ë©´ ê¸°ì¡´ì˜ ì½”ë“œë¥¼ ìˆ˜ì •í•´ì•¼ í•˜ë¯€ë¡œ OCP(Open Closed Principle)ì—ë„ ìœ„ë°°ë˜ëŠ” ê²ƒì´ë‹¤.

**ê¸°ëŒ€í–ˆë˜ ì˜ì¡´ ê´€ê³„**

![Untitled4.png](/assets/images/Spring_EX/Untitled 4.png)

**ì‹¤ì œ ì˜ì¡´ ê´€ê³„ ë‹¤ì´ì–´ê·¸ë¨**

![Untitled5.png](/assets/images/Spring_EX/Untitled 5.png)

> ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ëˆ„êµ°ê°€ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ OrderServiceImplì— DiscountPolicyì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ì…í•´ì£¼ì–´ì•¼ í•œë‹¤.
> 

## ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

---

ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ í•˜ë‚˜ì˜ ê³µì—°ì´ë¼ ìƒê°í•´ë³´ì. ê°ê°ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë°°ì—­(ë°°ìš° ì—­í• )ì´ë¼ í•˜ë©´ ì‹¤ì œ ë°°ì—­ì„ ë§ëŠ” ë°°ìš°ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì€ ëˆ„ê°€ í•˜ëŠ”ê°€? 

ì•ì„œ ì½”ë“œì—ì„œëŠ” ë°°ìš°ê°€ ì§ì ‘ ìƒëŒ€ì—­ì˜ ë°°ì—­ê³¼ ë°°ìš°ë¥¼ ì§ì ‘ ê³ ë¥´ëŠ”ê²ƒê³¼ ê°™ë‹¤. ë§ˆì¹˜ ë¡œë¯¸ì˜¤ ì—­í• (ì¸í„°í˜ì´ìŠ¤)ì„ í•˜ëŠ” ë ˆì˜¤ë‚˜ë¥´ë„ ë””ì¹´í”„ë¦¬ì˜¤(êµ¬í˜„ì²´, ë°°ìš°)ê°€ ì¤„ë¦¬ì—£(ì¸í„°í˜ì´ìŠ¤)ì„ í•˜ëŠ” ì—¬ì ì£¼ì¸ê³µ(êµ¬í˜„ì²´, ë°°ìš°)ì„ ì§ì ‘ ì´ˆë¹™í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ê²ƒì´ë‹¤. ì´ì²˜ëŸ¼ ë””ì¹´í”„ë¦¬ì˜¤ëŠ” ê³µì—°ë„ í•´ì•¼í•˜ê³ , ì—¬ì ì£¼ì¸ê³µì„ ì§ì ‘ ì´ˆë¹™í•´ì•¼ í•œë‹¤ëŠ” ë‹¤ì–‘í•œ ì±…ì„ì„ ê°–ê³  ìˆëŠ” ê²ƒì´ë‹¤.(SRP ìœ„ë°˜)

ì´ì²˜ëŸ¼, ë°°ìš°ëŠ” ë³¸ì¸ì˜ ì—­í• ì¸ ë°°ì—­ì—ë§Œ ì§‘ì¤‘í•´ì•¼ í•˜ë©°, ë°°ì—­ì— ë§ëŠ” ë°°ìš°ë¥¼ ìºìŠ¤íŒ… í•˜ëŠ”ê²ƒì€ ê³µì—° ê¸°íšìê°€ ë‹´ë‹¹í•´ì•¼ í•œë‹¤. ê³µì—° ê¸°íšìë¥¼ ë§Œë“¤ê³  ë°°ìš°ì™€ ê³µì—° ê¸°íšìì˜ **ì±…ì„ì„ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.**

**AppConfig**

ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ êµ¬ì„±í•˜ê³ , êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , ì—°ê²°í•˜ëŠ” ì±…ì„ì„ ê°–ëŠ” í´ë˜ìŠ¤ì´ë‹¤.

```java
public class AppConfig {

    public MemberService memberService() {
        return new MemberServiceImpl(getMemberRepository());
    }

    private static MemoryMemberRepository getMemberRepository() {
        return new MemoryMemberRepository();
    }

    public OrderService orderService() {
        return new OrderServiceImpl(getMemberRepository(), discountPolicy());
    }

    public DiscountPolicy discountPolicy() {
        return new FixDiscountPolicy();
    }
}
```

1. AppConfigëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤ì œ ë™ì‘ì— í•„ìš”í•œ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
2. AppConfigëŠ” ìƒì„±í•œ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ì˜ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ìƒì„±ìë¥¼ í†µí•´ì„œ ì£¼ì…í•´ì¤€ë‹¤.

**OrderServiceImpl**

```java
public class OrderServcieImpl implements OrderService {

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    public OrderServcieImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        int discount = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discount);
    }
}
```

ì´ë ‡ê²Œ ë˜ë©´ OrderServiceImpl ì½”ë“œëŠ” êµ¬í˜„ì œì— ì§ì ‘ ì˜ì¡´í•˜ì§€ ì•Šê³  ìƒì„±ìë¥¼ í†µí•´ Appconfigê°€ êµ¬í˜„ì²´ë¥¼ ì£¼ì…í•´ì£¼ê²Œ ëœë‹¤.

<aside>
ğŸ‘‰ AppConfigì˜ ë“±ì¥ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í¬ê²Œ **ì‚¬ìš© ì˜ì—­**ê³¼, ê°ì²´ë¥¼ ìƒì„±í•˜ê³  **êµ¬ì„±(Configuration)í•˜ëŠ”ì˜ì—­**ìœ¼ë¡œ ë¶„ë¦¬

</aside>

## IOC, DI ì»¨í…Œì´ë„ˆ

---

### IOC(Inversion of Control)

- ê¸°ì¡´ì— í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§ì ‘ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ì—°ê²°í•˜ê³  ì‹¤í–‰í•œ ê²ƒì€ êµ¬í˜„ ê°ì²´ê°€ ìŠ¤ìŠ¤ë¡œ í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ìŠ¤ìŠ¤ë¡œ ì¡°ì¢…í•œ ê²ƒì´ë‹¤.
- AppConfig í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œ í›„ ê°ì²´ëŠ” ìì‹ ì´ ë‹´ë‹¹í•˜ëŠ” ë¡œì§ë§Œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤. í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì€ AppConfigì—ì„œ ë‹´ë‹¹í•˜ì˜€ë‹¤.(ê³µì—° ê¸°íšì)
- AppConfigëŠ” OrderServiceImplì´ ì•„ë‹Œ OrderService ì¸í„°í˜ì´ìŠ¤ì˜ ë‹¤ë¥¸ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰í•  ìˆ˜ë„ ìˆë‹¤.

> **ì´ë ‡ê²Œ í”„ë¡œê·¸ë¨ì˜ ì œì–´ íë¦„ì„ ì§ì ‘ ì œì–´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì™¸ë¶€ì—ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ì œì–´ì˜ ì—­ì „(IOC)ë¼ê³  í•œë‹¤.**
> 

### í”„ë ˆì„ì›Œí¬ vs ë¼ì´ë¸ŒëŸ¬ë¦¬

- í”„ë ˆì„ì›Œí¬ëŠ” ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œë¥¼ ì œì–´í•˜ê³ , ì‹¤í–‰ì˜ íë¦„ì„ ì œì–´í•´ì¤€ë‹¤ë©´ í”„ë ˆì„ì›Œí¬(JUnit)
- ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œê°€ ì§ì ‘ ì œì–´ì˜ íë¦„ì„ ë‹´ë‹¹í•˜ë©´ ë¼ì´ë¸ŒëŸ¬ë¦¬

### DI(Dependency Inversion)

- ì• í”Œë¦¬ì¼€ì´ì…˜ **ì‹¤í–‰ ì‹œì (ëŸ°íƒ€ì„)**ì— ì™¸ë¶€ì—ì„œ ì‹¤ì œ êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•´ì„œ
í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì˜ ì‹¤ì œ ì˜ì¡´ê´€ê³„ê°€ ì—°ê²° ë˜ëŠ” ê²ƒì„ **ì˜ì¡´ê´€ê³„ ì£¼ì…**ì´ë¼ í•œë‹¤.

<aside>
ğŸ“– references ìŠ¤í”„ë§ í•µì‹¬ì›ë¦¬ -ê¸°ë³¸í¸ by ê¹€ì˜í•œ

</aside>